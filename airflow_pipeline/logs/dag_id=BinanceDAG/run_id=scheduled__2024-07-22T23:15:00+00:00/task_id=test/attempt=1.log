[2024-07-22T22:44:37.519-0300] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-07-22T22:44:37.525-0300] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: BinanceDAG.test scheduled__2024-07-22T23:15:00+00:00 [queued]>
[2024-07-22T22:44:37.533-0300] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: BinanceDAG.test scheduled__2024-07-22T23:15:00+00:00 [queued]>
[2024-07-22T22:44:37.533-0300] {taskinstance.py:2306} INFO - Starting attempt 1 of 1
[2024-07-22T22:44:37.545-0300] {taskinstance.py:2330} INFO - Executing <Task(BinanceOperator): test> on 2024-07-22 23:15:00+00:00
[2024-07-22T22:44:37.548-0300] {standard_task_runner.py:64} INFO - Started process 1057405 to run task
[2024-07-22T22:44:37.549-0300] {standard_task_runner.py:90} INFO - Running: ['airflow', 'tasks', 'run', 'BinanceDAG', 'test', 'scheduled__2024-07-22T23:15:00+00:00', '--job-id', '39', '--raw', '--subdir', 'DAGS_FOLDER/binance_dag.py', '--cfg-path', '/tmp/tmpvre8z9dc']
[2024-07-22T22:44:37.550-0300] {standard_task_runner.py:91} INFO - Job 39: Subtask test
[2024-07-22T22:44:37.576-0300] {task_command.py:426} INFO - Running <TaskInstance: BinanceDAG.test scheduled__2024-07-22T23:15:00+00:00 [running]> on host Galaxybook.
[2024-07-22T22:44:37.624-0300] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='airflow' AIRFLOW_CTX_DAG_ID='BinanceDAG' AIRFLOW_CTX_TASK_ID='test' AIRFLOW_CTX_EXECUTION_DATE='2024-07-22T23:15:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-07-22T23:15:00+00:00'
[2024-07-22T22:44:37.624-0300] {taskinstance.py:430} INFO - ::endgroup::
[2024-07-22T22:44:37.636-0300] {base.py:84} INFO - Using connection ID 'binance_default' for task execution.
[2024-07-22T22:44:37.637-0300] {base.py:84} INFO - Using connection ID 'binance_default' for task execution.
[2024-07-22T22:44:37.638-0300] {binance_hook.py:48} INFO - URL: https://api.binance.com/api/v3/klines?symbol=BTCBRL&interval=1m&startTime=1721699017425&endTime=1721699077425&timeZone=-3
[2024-07-22T22:44:38.023-0300] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-07-22T22:44:38.080-0300] {taskinstance.py:1206} INFO - Marking task as SUCCESS. dag_id=BinanceDAG, task_id=test, run_id=scheduled__2024-07-22T23:15:00+00:00, execution_date=20240722T231500, start_date=20240723T014437, end_date=20240723T014438
[2024-07-22T22:44:38.126-0300] {local_task_job_runner.py:243} INFO - Task exited with return code 0
[2024-07-22T22:44:38.132-0300] {taskinstance.py:3503} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-22T22:44:38.132-0300] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-07-22T22:46:33.310-0300] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-07-22T22:46:33.315-0300] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: BinanceDAG.test scheduled__2024-07-22T23:15:00+00:00 [queued]>
[2024-07-22T22:46:33.319-0300] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: BinanceDAG.test scheduled__2024-07-22T23:15:00+00:00 [queued]>
[2024-07-22T22:46:33.319-0300] {taskinstance.py:2306} INFO - Starting attempt 1 of 1
[2024-07-22T22:46:33.331-0300] {taskinstance.py:2330} INFO - Executing <Task(BinanceOperator): test> on 2024-07-22 23:15:00+00:00
[2024-07-22T22:46:33.333-0300] {standard_task_runner.py:64} INFO - Started process 1059889 to run task
[2024-07-22T22:46:33.335-0300] {standard_task_runner.py:90} INFO - Running: ['airflow', 'tasks', 'run', 'BinanceDAG', 'test', 'scheduled__2024-07-22T23:15:00+00:00', '--job-id', '77', '--raw', '--subdir', 'DAGS_FOLDER/binance_dag.py', '--cfg-path', '/tmp/tmpeo_xjdng']
[2024-07-22T22:46:33.336-0300] {standard_task_runner.py:91} INFO - Job 77: Subtask test
[2024-07-22T22:46:33.362-0300] {task_command.py:426} INFO - Running <TaskInstance: BinanceDAG.test scheduled__2024-07-22T23:15:00+00:00 [running]> on host Galaxybook.
[2024-07-22T22:46:33.412-0300] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='airflow' AIRFLOW_CTX_DAG_ID='BinanceDAG' AIRFLOW_CTX_TASK_ID='test' AIRFLOW_CTX_EXECUTION_DATE='2024-07-22T23:15:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-07-22T23:15:00+00:00'
[2024-07-22T22:46:33.412-0300] {taskinstance.py:430} INFO - ::endgroup::
[2024-07-22T22:46:33.425-0300] {base.py:84} INFO - Using connection ID 'binance_default' for task execution.
[2024-07-22T22:46:33.427-0300] {base.py:84} INFO - Using connection ID 'binance_default' for task execution.
[2024-07-22T22:46:33.427-0300] {binance_hook.py:48} INFO - URL: https://api.binance.com/api/v3/klines?symbol=BTCBRL&interval=1m&startTime=1721699133208&endTime=1721699193208&timeZone=-3
[2024-07-22T22:46:33.809-0300] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-07-22T22:46:33.867-0300] {taskinstance.py:1206} INFO - Marking task as SUCCESS. dag_id=BinanceDAG, task_id=test, run_id=scheduled__2024-07-22T23:15:00+00:00, execution_date=20240722T231500, start_date=20240723T014633, end_date=20240723T014633
[2024-07-22T22:46:33.909-0300] {local_task_job_runner.py:243} INFO - Task exited with return code 0
[2024-07-22T22:46:33.916-0300] {taskinstance.py:3503} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-22T22:46:33.916-0300] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-07-22T23:06:52.384-0300] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-07-22T23:06:52.391-0300] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: BinanceDAG.test scheduled__2024-07-22T23:15:00+00:00 [queued]>
[2024-07-22T23:06:52.394-0300] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: BinanceDAG.test scheduled__2024-07-22T23:15:00+00:00 [queued]>
[2024-07-22T23:06:52.394-0300] {taskinstance.py:2306} INFO - Starting attempt 1 of 1
[2024-07-22T23:06:52.405-0300] {taskinstance.py:2330} INFO - Executing <Task(BinanceOperator): test> on 2024-07-22 23:15:00+00:00
[2024-07-22T23:06:52.407-0300] {standard_task_runner.py:64} INFO - Started process 1078899 to run task
[2024-07-22T23:06:52.409-0300] {standard_task_runner.py:90} INFO - Running: ['airflow', 'tasks', 'run', 'BinanceDAG', 'test', 'scheduled__2024-07-22T23:15:00+00:00', '--job-id', '59', '--raw', '--subdir', 'DAGS_FOLDER/binance_dag.py', '--cfg-path', '/tmp/tmparxn90bv']
[2024-07-22T23:06:52.410-0300] {standard_task_runner.py:91} INFO - Job 59: Subtask test
[2024-07-22T23:06:52.438-0300] {task_command.py:426} INFO - Running <TaskInstance: BinanceDAG.test scheduled__2024-07-22T23:15:00+00:00 [running]> on host Galaxybook.
[2024-07-22T23:06:52.493-0300] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='airflow' AIRFLOW_CTX_DAG_ID='BinanceDAG' AIRFLOW_CTX_TASK_ID='test' AIRFLOW_CTX_EXECUTION_DATE='2024-07-22T23:15:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-07-22T23:15:00+00:00'
[2024-07-22T23:06:52.494-0300] {taskinstance.py:430} INFO - ::endgroup::
[2024-07-22T23:06:52.509-0300] {base.py:84} INFO - Using connection ID 'binance_default' for task execution.
[2024-07-22T23:06:52.511-0300] {base.py:84} INFO - Using connection ID 'binance_default' for task execution.
[2024-07-22T23:06:52.511-0300] {binance_hook.py:48} INFO - URL: https://api.binance.com/api/v3/klines?symbol=BTCBRL&interval=1m&startTime=1721700352278&endTime=1721700412278&timeZone=-3
[2024-07-22T23:06:52.629-0300] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-07-22T23:06:52.631-0300] {process_utils.py:132} INFO - Sending 15 to group 1078899. PIDs of all processes in the group: [1078899]
[2024-07-22T23:06:52.631-0300] {process_utils.py:87} INFO - Sending the signal 15 to group 1078899
[2024-07-22T23:06:52.631-0300] {taskinstance.py:2611} ERROR - Received SIGTERM. Terminating subprocesses.
[2024-07-22T23:06:52.632-0300] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-07-22T23:06:52.729-0300] {taskinstance.py:2905} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/hugoviana/Projetos/crypto-etl/.venv/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 465, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hugoviana/Projetos/crypto-etl/.venv/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 432, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hugoviana/Projetos/crypto-etl/.venv/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 401, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hugoviana/Projetos/crypto-etl/airflow_pipeline/operators/binance_operator.py", line 27, in execute
    r = BinanceHook(self.start_time, self.end_time, 'BTCBRL', '1m').run()
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hugoviana/Projetos/crypto-etl/airflow_pipeline/hook/binance_hook.py", line 55, in run
    return self.connect_to_endpoint(url_raw, session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hugoviana/Projetos/crypto-etl/airflow_pipeline/hook/binance_hook.py", line 49, in connect_to_endpoint
    return self.run_and_check(session, prep, {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hugoviana/Projetos/crypto-etl/.venv/lib/python3.12/site-packages/airflow/providers/http/hooks/http.py", line 236, in run_and_check
    response = session.send(prepped_request, **send_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hugoviana/Projetos/crypto-etl/.venv/lib/python3.12/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hugoviana/Projetos/crypto-etl/.venv/lib/python3.12/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/home/hugoviana/Projetos/crypto-etl/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py", line 715, in urlopen
    httplib_response = self._make_request(
                       ^^^^^^^^^^^^^^^^^^^
  File "/home/hugoviana/Projetos/crypto-etl/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py", line 467, in _make_request
    six.raise_from(e, None)
  File "<string>", line 3, in raise_from
  File "/home/hugoviana/Projetos/crypto-etl/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py", line 462, in _make_request
    httplib_response = conn.getresponse()
                       ^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/http/client.py", line 1428, in getresponse
    response.begin()
  File "/usr/lib/python3.12/http/client.py", line 331, in begin
    version, status, reason = self._read_status()
                              ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/http/client.py", line 292, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 707, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/ssl.py", line 1252, in recv_into
    return self.read(nbytes, buffer)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/ssl.py", line 1104, in read
    return self._sslobj.read(len, buffer)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hugoviana/Projetos/crypto-etl/.venv/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 2613, in signal_handler
    raise AirflowTaskTerminated("Task received SIGTERM signal")
airflow.exceptions.AirflowTaskTerminated: Task received SIGTERM signal
[2024-07-22T23:06:52.741-0300] {taskinstance.py:1206} INFO - Marking task as FAILED. dag_id=BinanceDAG, task_id=test, run_id=scheduled__2024-07-22T23:15:00+00:00, execution_date=20240722T231500, start_date=20240723T020652, end_date=20240723T020652
[2024-07-22T23:06:52.764-0300] {process_utils.py:80} INFO - Process psutil.Process(pid=1078899, status='terminated', exitcode=2, started='23:06:51') (1078899) terminated with exit code 2
